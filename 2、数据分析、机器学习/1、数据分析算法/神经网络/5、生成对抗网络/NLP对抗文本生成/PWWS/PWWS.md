#  `Probability Weighte Word Saliency (PWWS):`

## `一、PWWS 的介绍：`

* `PWWS 是一种基于单词显著性的文本对抗攻击的黑盒算法：`

* 具体而言，算法首先通过计算每个单词对分类结果的影响程度，即单词的显著性，来确定哪些单词应该被替换。然后，算法会尝试对每个单词进行不同的替换，并计算替换后分类概率的变化值，以衡量替换的攻击效果。最终，算法通过加权单词显著性和分类概率的变化值来确定最佳的替换词和替换顺序。

## `二、PWWS 的工作原理：`

* `首先在词的替换上需要满足：`

  * 1、词汇约束要求输入样本中的正确单词不能更改为常见的拼写错误单词，因为在分类器输入之前进行拼写检查可以很容易地消除这种干扰。

  * 2、此外，被扰乱的样本在语法上必须是正确的。

  * 3、对原始样本的修改不应导致语义约束所要求的语义的显著变化。

    为了满足上述的约束可以通过 `实体命名NE` 替换，因为它们提供了上下文信息和实体关系，可以帮助机器理解文本内容。例如，在一篇新闻文章中，命名实体可以帮助我们确定文章中涉及的人物、地点和组织机构，有助于我们更好地理解文章主题和相关事件。在命名实体识别任务中，我们的目标是从文本中自动识别出所有的命名实体，并将它们分类到不同的实体类型中。`用类似的NE替换NE会导致语义上的轻微变化，但不会引起词汇或语法上的变化。`

* `Word Substitution Strateg：`

  
    就是对于每一个词，都通过 wordNet 构建出它的同义词，然后存在 $L_i$ 里面，然后如果 $w_i$ 是一个实体命名，那么去找一个 $NE_adv$ 使其和 $w_i$ 保持一致，然后加入到 $L_i$ 中，然后在 $L_i$ 中依次拿出 $w_i'$ 来对原始的 $w_i$ 进行替换，我们希望可以找到一个 $w*$，使得(4)的结果最大。

    <div align=center><img  src="./static/pwws.png"/></div>

* `Replacement Order Strategy: `


    更进一步的，对于文本分类任务，每一个词在输入的样本中所占有的权重可能不一样，所以我们决定融合词的显著性这个概念来决定我们替换单词的顺序：

  * 词的显著性：
    
    在 NLP 中，文本生成的一个挑战是如何生成自然、连贯、逼真的文本。对抗性文本生成 (Adversarial Text Generation) 是一种方法，它使用对抗学习的技术，使生成的文本与真实的文本难以区分。在对抗性文本生成中，词的显著性 (Salience) 是一个重要的概念。

    `词的显著性指的是一个词在一句话中的重要性或显著程度。`在对抗性文本生成中，词的显著性可以帮助生成器更好地控制生成的文本，并提高文本的自然度和逼真度。例如，当生成器生成一个句子时，如果生成器能够识别出在这个句子中哪些词是最重要的，那么生成器可以更好地控制这些词的生成过程，从而生成更好的文本。

    词的显著性可以通过多种方式计算，例如词频、词义、上下文等等。对于对抗性文本生成任务，生成器通常会使用一些特殊的技术来计算词的显著性，例如基于注意力机制 (Attention) 的方法、基于梯度的方法等等。通过这些方法，生成器可以更好地控制生成的文本，并提高生成文本的自然度和逼真度。

* `词的显著性计算：`
    
    Word saliency refers to the degree of change in the output probability of the classifier if a word is set to unknown (out of vocabulary). The saliency of a word is computed as S(x, wi)：

    这句话主要是在讲述 word saliency（词汇重要性）的概念和计算方法。其中，“word saliency”指的是当一个单词被替换为“未知词”（out of vocabulary）时，分类器输出概率的变化程度。计算词汇重要性的公式为S(x, wi)，其中，x表示输入的文本序列，wi表示需要计算重要性的单词。该公式的结果可以用来确定对抗样本中哪些单词需要被替换或删除，以最大限度地影响分类器的输出。

    <div align=center><img  src="./static/saliency.png"/></div>

    通过这样计算出每一个单词的显著性，然后按照显著性的大小进行排序，从大小到小依次进行单词的替换：


## `三、pwws 的算法工作流程：`

* 1、输入原始文本样本和目标分类器，通过目标分类器得到每个单词的分类概率。

* 2、计算每个单词的词汇重要性，这里可以使用一些方法来衡量，比如TF-IDF，TF-IDF加权后的词向量，或者是基于神经网络的方法，如基于注意力机制的方法。

* 3、为了避免对整个文本进行修改，选择仅对一小部分单词进行修改。可以通过采样或者是设置阈值的方法来确定需要修改的单词集合。

* 4、对于每个需要修改的单词，使用一个候选词集合来生成替换候选，候选词集合可以是原始文本中该单词的同义词集合或者是通过外部知识库（如WordNet）生成的同义词集合。

* 5、对于每个替换候选，使用编辑距离（如Levenshtein Distance）来衡量替换的代价，选择编辑距离最小的替换候选（计算得到同义词）。

* 6、计算替换后的文本在目标分类器上的分类概率，并计算替换前后概率的差值，这个差值可以表示出替换对分类结果的影响大小。

* 7、将差值乘以词汇重要性，得到加权的差值，这个加权的差值可以看做是衡量替换单词是否有效的指标。

* 8、对于所有替换单词的替换候选，选择加权差值最大的替换单词作为最终的替换单词。

* 9、重复执行4-8步，直到满足指定的停止条件。

* 10、输出生成的对抗样本，其中替换单词的顺序可以根据加权差值进行排序，以便更好地呈现攻击效果

<div align=center><img  src="./static/pwws al.png"/></div>


## `PWWS 效果展示：`


<div align=center><img  src="./static/finally.png"/></div>

